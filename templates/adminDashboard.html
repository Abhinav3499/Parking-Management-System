<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #fff; }
        .navbar { background: #c8efc8; padding: 10px; border-radius: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .navbar .left { color: #d44; font-weight: bold; font-size: 1.2em; }
        .navbar .center a { color: #222; text-decoration: none; margin: 0 10px; font-size: 1.1em; }
        .navbar .center a:hover { text-decoration: underline; }
        .navbar .right a { color: #1a7fc1; text-decoration: none; font-weight: bold; }
        .lots-container { margin: 0 auto; max-width: 1200px; }
        .lots-title { font-size: 2em; color: #2366b8; margin-bottom: 20px; text-align: center; }
        .lots-list { display: flex; flex-wrap: wrap; gap: 30px; justify-content: flex-start; }
        .lot-box { border: 2px solid #2366b8; border-radius: 20px; padding: 20px; min-width: 270px; background: #f8fbff; box-shadow: 2px 2px 8px #eee; }
        .lot-title { font-size: 1.2em; font-weight: bold; margin-bottom: 5px; }
        .lot-actions { margin-bottom: 8px; }
        .lot-actions a, .lot-actions form { display: inline; }
        .lot-actions a { color: #e67e22; margin-right: 8px; text-decoration: none; font-weight: bold; }
        .lot-actions a:hover { text-decoration: underline; }
        .lot-actions button { color: #e74c3c; background: none; border: none; cursor: pointer; font-weight: bold; }
        .occupied { color: #1abc9c; font-weight: bold; margin-bottom: 10px; }
        .spots-grid { display: grid; grid-template-columns: repeat(5, 32px); gap: 7px; margin-bottom: 10px; }
        .spot-btn-form { display: inline; }
        .spot-btn { width: 32px; height: 32px; border-radius: 7px; border: 2px solid #2366b8; font-size: 1.1em; font-weight: bold; background: #eaf6ff; color: #2366b8; cursor: pointer; margin: 0; padding: 0; }
        .spot-btn.occupied { background: #ffd6d6; color: #e74c3c; border-color: #e74c3c; }
        .add-lot-btn { margin: 30px auto 0 auto; display: block; background: #eaf6ff; color: #e67e22; border: 2px solid #e67e22; border-radius: 10px; font-size: 1.2em; padding: 12px 40px; cursor: pointer; font-weight: bold; box-shadow: 1px 1px 6px #eee; }
        .add-lot-btn:hover { background: #fffbe6; }
    </style>
</head>
<body>
    <div class="navbar">
        <span class="left">Welcome to Admin</span>
        <span class="center">
            <a href="{{ url_for('admin.dashboard') }}">Home</a> |
            <a href="{{ url_for('admin.users') }}">Users</a> |
            <a href="{{ url_for('admin.search') }}">Search</a> |
            <a href="{{ url_for('admin.dashboard') }}">Summary</a> |
            <a href="{{ url_for('auth.logout') }}">Logout</a>
        </span>
        <span class="right"><a href="{{ url_for('auth.edit_profile') }}">Edit Profile</a></span>
    </div>
    <div class="lots-container">
        <div class="lots-title">Parking Lots</div>
        <div class="lots-list">
            {% for lot in parking_lots %}
            <div class="lot-box">
                <div class="lot-title">Parking#{{ lot.id }}</div>
                <div class="lot-actions">
                    <a href="{{ url_for('admin.edit_parking_lot', lot_id=lot.id) }}">Edit</a> |
                    <form action="{{ url_for('admin.delete_parking_lot', lot_id=lot.id) }}" method="post" style="display:inline;" onsubmit="return confirm('Are you sure?');">
                        <button type="submit">Delete</button>
                    </form>
                </div>
                <div class="occupied">(Occupied : {{ lot.spots|selectattr('status', 'equalto', 'O')|list|length }}/{{ lot.spots|length }})</div>
                <div class="spots-grid">
                    {% for spot in lot.spots|sort(attribute='spot_number') %}
                        {% if spot.status == 'A' %}
                        <form class="spot-btn-form" action="{{ url_for('admin.delete_spot', spot_id=spot.id) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this available spot?');">
                            <button type="submit" class="spot-btn" title="Delete Spot #{{ spot.spot_number }}">
                                {{ spot.status }}
                            </button>
                        </form>
                        {% else %}
                        <a href="{{ url_for('admin.spot_details', spot_id=spot.id) }}" class="spot-btn occupied" title="View Booking Details for Spot #{{ spot.spot_number }}" style="display:inline-block; text-align:center; line-height:32px;">
                            {{ spot.status }}
                        </a>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
        <a href="{{ url_for('admin.add_parking_lot') }}" class="add-lot-btn">+ Add Lot</a>
    </div>
</body>
</html>
